<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding Tidiers to Broom • broom</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- tidyverse --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">broom</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/broom.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adding-tidiers.html">Adding new tidiers</a>
    </li>
    <li>
      <a href="../articles/available-methods.html">Available methods</a>
    </li>
    <li>
      <a href="../articles/bootstrapping.html">Bootstrapping</a>
    </li>
    <li>
      <a href="../articles/broom_and_dplyr.html">Broom and dplyr</a>
    </li>
    <li>
      <a href="../articles/kmeans.html">K-means</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidyverse/broom">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adding Tidiers to Broom</h1>
            
            <h4 class="date">2018-06-07</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/tidyverse/broom/blob/master/vignettes/adding-tidiers.Rmd"><code>vignettes/adding-tidiers.Rmd</code></a></small>
      <div class="hidden name"><code>adding-tidiers.Rmd</code></div>

    </div>

    
    
<div id="adding-new-tidiers-to-broom" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-new-tidiers-to-broom" class="anchor"></a>Adding new tidiers to broom</h1>
<p>Thank you for your interest in adding new tidiers to broom! This document is a <em>work in progress</em> describing the conventions that broom follows.</p>
<p>Some general guidelines:</p>
<ul>
<li>Try to reach a minimum 90% test coverage for new tidiers</li>
<li>
<code>tidy</code>, <code>glance</code> and <code>augment</code> methods <em>must</em> return tibbles</li>
<li>Use the <a href="http://style.tidyverse.org/">tidyverse style conventions</a>
</li>
<li>Feel free to add yourself as a contributor to <code>DESCRIPTION</code>
</li>
</ul>
<!-- TODOS: --><!-- - Helper functions that you should be aware of and use --><!-- - Preferred packages to use: i.e. new tidyverse not old --><!-- Comments about tidiers living in external packages -->
</div>
<div id="tidy" class="section level1">
<h1 class="hasAnchor">
<a href="#tidy" class="anchor"></a><code>tidy</code>
</h1>
<p>Each row in a <code>tidy</code> output provides information about the components of a model, such as one term in a regression, one test, or one cluster/class. This meaning varies across models but is usually self-evident.</p>
<div id="column-names-to-use-in-output" class="section level2">
<h2 class="hasAnchor">
<a href="#column-names-to-use-in-output" class="anchor"></a>Column names to use in output</h2>
<ul>
<li>
<code>term</code>: the term in a regression or model that is being estimated.</li>
<li>
<code>p.value</code>: the p-value associated with a test statistic</li>
<li>
<code>statistic</code>: a test statistic, usually the one used to compute the p-value. Combining these across many sub-groups is a reliable way to perform (e.g.) bootstrap hypothesis testing</li>
<li>
<code>estimate</code>: estimate of an effect size, slope, or other value</li>
<li>
<code>std.error</code>: standard error</li>
<li>
<code>conf.low</code>: the low end of a confidence interval on the <code>estimate</code>
</li>
<li>
<code>conf.high</code>: the high end of a confidence interval on the <code>estimate</code>
</li>
<li>
<code>df</code>: degrees of freedom</li>
</ul>
</div>
</div>
<div id="glance" class="section level1">
<h1 class="hasAnchor">
<a href="#glance" class="anchor"></a><code>glance</code>
</h1>
<p>The <code>glance</code> method accepts a model object and returns a tibble with a single row of model level summaries.</p>
<p>Do not include arguments <em>given</em> to the modeling function. For example, a <code>glm</code> glance output does not need to contain a field for <code>family</code>, since that is decided by the user calling <code>glm</code> rather than the modeling function itself.</p>
<div id="column-names-to-use-in-output-1" class="section level2">
<h2 class="hasAnchor">
<a href="#column-names-to-use-in-output-1" class="anchor"></a>Column names to use in output:</h2>
<ul>
<li>
<code>r.squared</code> the fraction of variance explained by the model</li>
<li>
<code>adj.r.squared</code> R^2 adjusted based on the degrees of freedom</li>
<li>
<code>sigma</code> the square root of the estimated variance of the residuals</li>
</ul>
</div>
</div>
<div id="augment" class="section level1">
<h1 class="hasAnchor">
<a href="#augment" class="anchor"></a><code>augment</code>
</h1>
<p>The <code>augment</code> method accepts a model object and optionally a data frame and returns a tibble of data with additional observation level information. <code>augment</code> should be used for information related to individual data points.</p>
<ul>
<li>
<code><a href="../reference/augment.html">augment(model, data)</a></code> adds columns to the original data.
<ul>
<li>If the <code>data</code> argument is missing, <code>augment</code> attempts to reconstruct the data from the model (note that this may not always be possible, and usually won’t contain columns not used in the model).</li>
</ul>
</li>
</ul>
<p><code><a href="../reference/augment.html">augment(object)</a></code> should return a tibble of summaries for the original observations.</p>
<p><code><a href="../reference/augment.html">augment(object, newdata = newdata)</a></code> should return a tibble of observation level summaries for a new data frame.</p>
<p>Each row in <code><a href="../reference/augment.html">augment(object)</a></code> should correspond to a single row of the original data, or a single row of <code>newdata</code> if <code>newdata</code> was passed as an argument.</p>
<p>If the original data contained rownames, <code>augment</code> should return them in a column called <code>.rownames</code>.</p>
<p>Newly added column names begin with <code>.</code> to avoid overwriting columns in the original data.</p>
<div id="arguments-that-may-be-relevant" class="section level2">
<h2 class="hasAnchor">
<a href="#arguments-that-may-be-relevant" class="anchor"></a>Arguments that may be relevant:</h2>
<ul>
<li>x: object to augment</li>
<li>type.residuals</li>
<li>type.predict</li>
<li>data</li>
<li>newdata</li>
<li>weights</li>
</ul>
</div>
<div id="column-names-to-use-in-output-2" class="section level2">
<h2 class="hasAnchor">
<a href="#column-names-to-use-in-output-2" class="anchor"></a>Column names to use in output</h2>
<ul>
<li>
<code>.fitted</code>: the predicted values, on the same scale as the data.</li>
<li>
<code>.resid</code>: residuals: the actual response values minus the fitted values</li>
<li>
<code>.cluster</code>: cluster assignments</li>
</ul>
</div>
</div>
<div id="testing-new-tidiers" class="section level1">
<h1 class="hasAnchor">
<a href="#testing-new-tidiers" class="anchor"></a>Testing new tidiers</h1>
<div id="basic-checks" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-checks" class="anchor"></a>Basic checks</h2>
<p>All <code>tidy</code> methods should <code>check_tidy</code>, all <code>glance</code> methods should pass <code>check_glance</code> and all <code>augment</code> methods should pass <code>check_augment</code>. That is, your test should include:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tidy.html">tidy</a></span>(object)
g &lt;-<span class="st"> </span><span class="kw"><a href="../reference/glance.html">glance</a></span>(object)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/augment.html">augment</a></span>(object)

<span class="kw">check_tidy</span>(t)
<span class="kw">check_glance</span>(g)
<span class="kw">check_augment</span>(a)</code></pre></div>
</div>
<div id="package-dependencies" class="section level2">
<h2 class="hasAnchor">
<a href="#package-dependencies" class="anchor"></a>Package dependencies</h2>
<p>In order to test your tidiers, you may need to add <code>your_package</code> to the <strong>Suggested</strong> section of broom’s DESCRIPTION.</p>
<p>Here’s a outline that you can use for your test file</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># </span><span class="al">TODO</span><span class="co">. requireNamespace(package, quietly = TRUE)?</span></code></pre></div>
<p>At the moment, pull requests must pass the AppVeyor build to be added to <code>broom</code>. It is okay if the Travis CI build times out.</p>
</div>
<div id="catching-edge-cases" class="section level2">
<h2 class="hasAnchor">
<a href="#catching-edge-cases" class="anchor"></a>Catching edge cases</h2>
<p>Many modelling function allow users to specify a variety of options. For example, <code>glm</code> allows various response types via the <code>family</code> argument. Good tests for <code>glm</code> tidying methods would test tidiers on <code>glm</code> objects fit for all acceptable values of <code>family</code>.</p>
</div>
</div>
<div id="before-submitting-your-pull-request" class="section level1">
<h1 class="hasAnchor">
<a href="#before-submitting-your-pull-request" class="anchor"></a>Before submitting your pull request</h1>
<ul>
<li>Make sure that you have run and passed:
<ul>
<li><code><a href="http://www.rdocumentation.org/packages/devtools/topics/spell_check">devtools::spell_check()</a></code></li>
<li><code><a href="http://www.rdocumentation.org/packages/goodpractice/topics/gp">goodpractice::gp()</a></code></li>
</ul>
</li>
<li>Run <code><a href="http://pkgdown.r-lib.org/reference/build_site.html">pkgdown::build_site()</a></code> so that your documentation gets added to the broom</li>
<li>R CMD check</li>
</ul>
<p>An effective pull request should contain a big picture summary of what you’ve done and a brief example usage in the pull request text.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#adding-new-tidiers-to-broom">Adding new tidiers to broom</a></li>
      <li>
<a href="#tidy"><code>tidy</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#column-names-to-use-in-output">Column names to use in output</a></li>
      </ul>
</li>
      <li>
<a href="#glance"><code>glance</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#column-names-to-use-in-output-1">Column names to use in output:</a></li>
      </ul>
</li>
      <li>
<a href="#augment"><code>augment</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#arguments-that-may-be-relevant">Arguments that may be relevant:</a></li>
      <li><a href="#column-names-to-use-in-output-2">Column names to use in output</a></li>
      </ul>
</li>
      <li>
<a href="#testing-new-tidiers">Testing new tidiers</a><ul class="nav nav-pills nav-stacked">
<li><a href="#basic-checks">Basic checks</a></li>
      <li><a href="#package-dependencies">Package dependencies</a></li>
      <li><a href="#catching-edge-cases">Catching edge cases</a></li>
      </ul>
</li>
      <li><a href="#before-submitting-your-pull-request">Before submitting your pull request</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="tidyverse">
  <p>broom is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by David Robinson.</p>
  <p>Site built by <a href="http://pkgdown.r-lib.org">pkgdown</a>.</p>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script></footer>
</div>

  

  </body>
</html>
